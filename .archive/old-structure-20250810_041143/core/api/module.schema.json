{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Clauder Module Schema",
  "type": "object",
  "required": ["name", "version", "type"],
  "properties": {
    "name": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9-]*$",
      "description": "Module name (lowercase, hyphen-separated)"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-z]+\\.\\d+)?$",
      "description": "Semantic version (e.g., 1.0.0, 2.1.0-beta.1)"
    },
    "type": {
      "type": "string",
      "enum": ["core", "workflow", "validation", "tool", "convention", "custom"],
      "description": "Module type"
    },
    "description": {
      "type": "string",
      "maxLength": 200,
      "description": "Brief module description"
    },
    "author": {
      "type": "string",
      "description": "Module author"
    },
    "license": {
      "type": "string",
      "default": "MIT",
      "description": "License type"
    },
    "provides": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Capabilities provided by this module"
    },
    "requires": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Capabilities required by this module"
    },
    "dependencies": {
      "type": "object",
      "additionalProperties": {
        "type": "string",
        "pattern": "^(\\^|~|>=?|<=?|=)?\\d+\\.\\d+\\.\\d+$"
      },
      "description": "Module dependencies with version constraints"
    },
    "config": {
      "type": "object",
      "description": "Module configuration schema",
      "properties": {
        "schema": {
          "type": "object",
          "description": "JSON Schema for module configuration"
        },
        "defaults": {
          "type": "object",
          "description": "Default configuration values"
        }
      }
    },
    "hooks": {
      "type": "object",
      "properties": {
        "install": {
          "type": "string",
          "description": "Script to run on module installation"
        },
        "uninstall": {
          "type": "string",
          "description": "Script to run on module removal"
        },
        "upgrade": {
          "type": "string",
          "description": "Script to run on module upgrade"
        },
        "pre-init": {
          "type": "string",
          "description": "Script to run before initialization"
        },
        "post-init": {
          "type": "string",
          "description": "Script to run after initialization"
        },
        "cleanup": {
          "type": "string",
          "description": "Script to run on cleanup"
        }
      },
      "additionalProperties": false
    },
    "exports": {
      "type": "object",
      "properties": {
        "commands": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Commands exported by the module"
        },
        "templates": {
          "type": "string",
          "description": "Path to templates directory"
        },
        "tools": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tools provided by the module"
        }
      }
    },
    "files": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Files included in the module"
    },
    "directories": {
      "type": "object",
      "properties": {
        "src": {
          "type": "string",
          "default": "src",
          "description": "Source code directory"
        },
        "templates": {
          "type": "string",
          "default": "templates",
          "description": "Templates directory"
        },
        "tests": {
          "type": "string",
          "default": "tests",
          "description": "Tests directory"
        },
        "hooks": {
          "type": "string",
          "default": "hooks",
          "description": "Hooks directory"
        },
        "bin": {
          "type": "string",
          "default": "bin",
          "description": "Binaries directory"
        }
      }
    },
    "compatibility": {
      "type": "object",
      "properties": {
        "clauder": {
          "type": "string",
          "pattern": "^(\\^|~|>=?|<=?|=)?\\d+\\.\\d+\\.\\d+$",
          "description": "Compatible Clauder versions"
        },
        "os": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["darwin", "linux", "windows"]
          },
          "description": "Compatible operating systems"
        },
        "shell": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["bash", "zsh", "sh"]
          },
          "description": "Compatible shells"
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "homepage": {
          "type": "string",
          "format": "uri",
          "description": "Module homepage"
        },
        "repository": {
          "type": "string",
          "format": "uri",
          "description": "Source repository"
        },
        "bugs": {
          "type": "string",
          "format": "uri",
          "description": "Issue tracker"
        },
        "keywords": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Keywords for discovery"
        }
      }
    }
  }
}